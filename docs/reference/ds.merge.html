<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Merges two data frames in the server-side — ds.merge • dsBaseClient</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Merges two data frames in the server-side — ds.merge" />
<meta property="og:description" content="Merges (links) two data frames together based on common
values in defined vectors in each data frame." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dsBaseClient</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">6.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Merges two data frames in the server-side</h1>
    
    <div class="hidden name"><code>ds.merge.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Merges (links) two data frames together based on common
values in defined vectors in each data frame.</p>
    </div>

    <pre class="usage"><span class='fu'>ds.merge</span>(
  x.name = <span class='kw'>NULL</span>,
  y.name = <span class='kw'>NULL</span>,
  by.x.names = <span class='kw'>NULL</span>,
  by.y.names = <span class='kw'>NULL</span>,
  all.x = <span class='fl'>FALSE</span>,
  all.y = <span class='fl'>FALSE</span>,
  sort = <span class='fl'>TRUE</span>,
  suffixes = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>".x"</span>, <span class='st'>".y"</span>),
  no.dups = <span class='fl'>TRUE</span>,
  incomparables = <span class='kw'>NULL</span>,
  newobj = <span class='kw'>NULL</span>,
  datasources = <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x.name</th>
      <td><p>a character string specifying the name of the
first data frame to be merged. The length of the string should be less than the 
specified threshold for the nfilter.stringShort which is one of the disclosure 
prevention checks in DataSHIELD.</p></td>
    </tr>
    <tr>
      <th>y.name</th>
      <td><p>a character string specifying the name of the
second data frame to be merged. The length of the string should be less than the 
specified threshold for the nfilter.stringShort which is one of the disclosure 
prevention checks in DataSHIELD.</p></td>
    </tr>
    <tr>
      <th>by.x.names</th>
      <td><p>a character string  or a vector of names specifying 
of the column(s) in data frame <code>x.name</code> for merging.</p></td>
    </tr>
    <tr>
      <th>by.y.names</th>
      <td><p>a character string  or a vector of names specifying 
of the column(s) in data frame <code>y.name</code> for merging.</p></td>
    </tr>
    <tr>
      <th>all.x</th>
      <td><p>logical. If TRUE then extra rows will be added to the output,
one for each row in <code>x.name</code> that has no matching row in <code>y.name</code>. 
If FALSE the rows with data from both data frames are included in the output.
Default FALSE.</p></td>
    </tr>
    <tr>
      <th>all.y</th>
      <td><p>logical. If TRUE then extra rows will be added to the output,
one for each row in <code>y.name</code> that has no matching row in <code>x.name</code>. 
If FALSE the rows with data from both data frames are included in the output.
Default FALSE.</p></td>
    </tr>
    <tr>
      <th>sort</th>
      <td><p>logical. If TRUE the merged result is sorted on elements
in the <code>by.x.names</code> and <code>by.y.names</code> columns. Default TRUE.</p></td>
    </tr>
    <tr>
      <th>suffixes</th>
      <td><p>a character vector of length 2 specifying the suffixes to be used for
making unique common column names in the two input data frames
when they both appear in the merged data frame.</p></td>
    </tr>
    <tr>
      <th>no.dups</th>
      <td><p>logical. Suffixes are appended in more cases to
avoid duplicated column names in the merged data frame. Default TRUE
(FALSE before R version 3.5.0).</p></td>
    </tr>
    <tr>
      <th>incomparables</th>
      <td><p>values that cannot be matched. This is intended to 
be used for merging on
one column, so these are incomparable values of that column.
For more information see <code>match</code> in native R <code>merge</code> function.</p></td>
    </tr>
    <tr>
      <th>newobj</th>
      <td><p>a character string that provides the name for the output 
variable that is stored on the data servers. Default <code>merge.newobj</code>.</p></td>
    </tr>
    <tr>
      <th>datasources</th>
      <td><p>a list of <code><a href='https://rdrr.io/pkg/DSI/man/DSConnection-class.html'>DSConnection-class</a></code> 
objects obtained after login. If the <code>datasources</code> argument is not specified
the default set of connections will be used: see <code><a href='https://rdrr.io/pkg/DSI/man/datashield.connections_default.html'>datashield.connections_default</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>ds.merge</code> returns the merged data frame that is written on the server-side. 
Also, two validity messages are returned to the client-side
indicating whether the new object has been created in each data source and if so whether
it is in a valid form.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is similar to the native R function <code>merge</code>.
There are some changes compared with the native R function 
in choosing which variables to use to merge the data frames, the function <code>merge</code>
is very flexible. For example, you can choose to merge
using all vectors that appear in both data frames. However, for <code>ds.merge</code>
in DataSHIELD it is required that all the vectors which dictate the merging
are explicitly identified for both data frames using the <code>by.x.names</code> and
<code>by.y.names</code> arguments.</p>
<p>Server function called: <code>mergeDS</code></p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>DataSHIELD Development Team</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>if</span> (<span class='fl'>FALSE</span>) {

 <span class='co'>## Version 6, for version 5 see the Wiki</span>
  
  <span class='co'># connecting to the Opal servers</span>

  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='st'><a href='https://github.com/datashield/DSI'>'DSI'</a></span>)
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='st'><a href='https://www.obiba.org'>'DSOpal'</a></span>)
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='st'>'dsBaseClient'</span>)

  <span class='kw'>builder</span> <span class='op'>&lt;-</span> <span class='kw'>DSI</span>::<span class='fu'><a href='https://rdrr.io/pkg/DSI/man/newDSLoginBuilder.html'>newDSLoginBuilder</a></span>()
  <span class='kw'>builder</span><span class='op'>$</span><span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span>(server = <span class='st'>"study1"</span>, 
                 url = <span class='st'>"http://192.168.56.100:8080/"</span>, 
                 user = <span class='st'>"administrator"</span>, password = <span class='st'>"datashield_test&amp;"</span>, 
                 table = <span class='st'>"CNSIM.CNSIM1"</span>, driver = <span class='st'>"OpalDriver"</span>)
  <span class='kw'>builder</span><span class='op'>$</span><span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span>(server = <span class='st'>"study2"</span>, 
                 url = <span class='st'>"http://192.168.56.100:8080/"</span>, 
                 user = <span class='st'>"administrator"</span>, password = <span class='st'>"datashield_test&amp;"</span>, 
                 table = <span class='st'>"CNSIM.CNSIM2"</span>, driver = <span class='st'>"OpalDriver"</span>)
  <span class='kw'>builder</span><span class='op'>$</span><span class='fu'><a href='https://rdrr.io/r/base/append.html'>append</a></span>(server = <span class='st'>"study3"</span>,
                 url = <span class='st'>"http://192.168.56.100:8080/"</span>, 
                 user = <span class='st'>"administrator"</span>, password = <span class='st'>"datashield_test&amp;"</span>, 
                 table = <span class='st'>"CNSIM.CNSIM3"</span>, driver = <span class='st'>"OpalDriver"</span>)
  <span class='kw'>logindata</span> <span class='op'>&lt;-</span> <span class='kw'>builder</span><span class='op'>$</span><span class='fu'><a href='https://rdrr.io/r/utils/PkgUtils.html'>build</a></span>()
  
  <span class='kw'>connections</span> <span class='op'>&lt;-</span> <span class='kw'>DSI</span>::<span class='fu'><a href='https://rdrr.io/pkg/DSI/man/datashield.login.html'>datashield.login</a></span>(logins = <span class='kw'>logindata</span>, assign = <span class='fl'>TRUE</span>, symbol = <span class='st'>"D"</span>) 
  
  <span class='co'>#Create two data frames with a common column</span>
  
  <span class='fu'><a href='ds.dataFrame.html'>ds.dataFrame</a></span>(x = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"D$LAB_TSC"</span>,<span class='st'>"D$LAB_TRIG"</span>,<span class='st'>"D$LAB_HDL"</span>,<span class='st'>"D$LAB_GLUC_ADJUSTED"</span>),
               completeCases = <span class='fl'>TRUE</span>,
               newobj = <span class='st'>"df.x"</span>,
               datasources = <span class='kw'>connections</span>)
               
  <span class='fu'><a href='ds.dataFrame.html'>ds.dataFrame</a></span>(x = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"D$LAB_TSC"</span>,<span class='st'>"D$GENDER"</span>,<span class='st'>"D$PM_BMI_CATEGORICAL"</span>,<span class='st'>"D$PM_BMI_CONTINUOUS"</span>),
               completeCases = <span class='fl'>TRUE</span>,
               newobj = <span class='st'>"df.y"</span>,
               datasources = <span class='kw'>connections</span>) 
               
  <span class='co'># Merge data frames using the common variable "LAB_TSC"</span>
               
  <span class='fu'>ds.merge</span>(x.name = <span class='st'>"df.x"</span>,
           y.name = <span class='st'>"df.y"</span>,
           by.x.names = <span class='st'>"df.x$LAB_TSC"</span>,
           by.y.names = <span class='st'>"df.y$LAB_TSC"</span>,
           all.x = <span class='fl'>TRUE</span>,
           all.y = <span class='fl'>TRUE</span>,
           sort = <span class='fl'>TRUE</span>,
           suffixes = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>".x"</span>, <span class='st'>".y"</span>),
           no.dups = <span class='fl'>TRUE</span>,
           newobj = <span class='st'>"df.merge"</span>,
           datasources = <span class='kw'>connections</span>)              
  
  <span class='co'># clear the Datashield R sessions and logout</span>
  <span class='fu'><a href='https://rdrr.io/pkg/DSI/man/datashield.logout.html'>datashield.logout</a></span>(<span class='kw'>connections</span>)
}

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by DataSHIELD Developers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


